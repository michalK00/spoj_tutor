{% extends 'base.html' %}
{% load static %}
{% load paginator_tags %}

{% block stylesheet %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'css/tasks.css' %}">
{% endblock stylesheet %}
{% block content %}


    <div class="container">
        {% include 'includes/table_nav.html' %}
        <table class="table-responsive-sm table  table-striped my-2">
            <thead class="table-dark ">
            <tr>
                <th style="width: 50%">Task</th>
                <th style="width: 15%">Difficulty</th>
                <th>Source</th>
                {% if user.is_authenticated %}
                    <th>Status</th>
                {% endif %}
            </tr>
            </thead>
            <tbody>
            {% for task in tasks %}
                <tr>
                    <td class="align-middle"><a class="link" href="{% url 'single_task' task.id %}">{{ task.title }} </a></td>
                    <td class="align-middle">
                        <div class="diff container-lg rounded-2" id="diff">{{ task.difficulty | add:1 }}/{{ task.spoj.amount_of_difficulty_levels }}</div>
                    </td>
                    <td class="align-middle"><a class="link" href={{ task.url }} target="_blank"
                                                rel="noopener noreferrer">{{ task.spoj }}</a></td>
                    {% if user.is_authenticated %}

                        <td class="align-right"><a class="bp3-align-right btn btn-dark" href="#"
                        >Add</a></td>
                    {% endif %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% include 'includes/table_pagination.html' %}
{% endblock content %}
{% block scripts %}
    <script>
        const difficulty_divs = document.getElementsByClassName('diff container-lg rounded-2')
        for (let i = 0; i < difficulty_divs.length; i++) {
            const level = parseInt(difficulty_divs[i].innerText.split('/')[0])
            const all_levels = parseInt(difficulty_divs[i].innerText.split('/')[1])

            const div_color = 'hsl(' + (100 - 100.0 / (all_levels - 1) * (level - 1)) + ', 55%, 70%)';
            const font_color = 'hsl(' + (100 - 100.0 / (all_levels - 1) * (level - 1)) + ', 85%, 95%)';
            difficulty_divs[i].style.backgroundColor = div_color;
            difficulty_divs[i].style.color = font_color;
        }

    </script>
{% endblock scripts %}